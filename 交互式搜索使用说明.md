# 胰腺癌临床试验交互式搜索使用说明

## 📋 功能概述

本系统现已支持完整的交互式搜索功能，用户可以通过命令行界面自定义搜索参数，包括：

- 🔍 **自定义搜索关键词**
- 📅 **首次发布日期过滤**
- 🔬 **试验阶段选择** (0-4期)
- 📊 **试验状态筛选**
- ⏰ **搜索时间范围**

## 🚀 快速开始

### 运行主程序
```bash
python3 pancreatic_cancer_trials_v2.py
```

### 交互式参数设置

程序启动后，系统会依次提示您输入以下参数：

#### 1️⃣ 搜索关键词
```
请输入搜索关键词 (默认: pancreatic cancer): 
```

**示例输入：**
- `pancreatic cancer` (默认)
- `pancreatic adenocarcinoma`
- `PDAC`
- `pancreatic ductal adenocarcinoma`
- 直接回车使用默认值

#### 2️⃣ 首次发布日期
```
请输入首次发布日期 (YYYY-MM-DD格式，如: 2025-01-01): 
```

**示例输入：**
- `2025-01-01` (从2025年1月1日开始)
- `2024-12-01` (从2024年12月1日开始)
- 直接回车跳过此过滤条件

#### 3️⃣ 搜索天数
```
请输入搜索天数 (默认30天): 
```

**示例输入：**
- `30` (默认，最近30天)
- `60` (最近60天)
- `90` (最近90天)
- 直接回车使用默认30天

#### 4️⃣ 试验阶段选择
```
试验阶段选择:
   0: 0期 (早期1期), 1: 1期, 2: 2期, 3: 3期, 4: 4期
   默认: 包含所有阶段 (0-4期)
请输入阶段 (如: 1,2,3 或回车选择全部): 
```

**示例输入：**
- `1,2,3` (选择1-3期试验)
- `2,3` (仅2-3期试验)
- `4` (仅4期试验)
- 直接回车选择全部阶段

#### 5️⃣ 试验状态选择
```
试验状态选择:
   RECRUITING: 招募中
   NOT_YET_RECRUITING: 尚未开始招募
   ACTIVE_NOT_RECRUITING: 活跃但不招募
   默认: 仅招募中的试验
请输入状态 (如: RECRUITING 或回车使用默认): 
```

**示例输入：**
- `RECRUITING` (仅招募中，默认)
- `RECRUITING NOT_YET_RECRUITING` (招募中和即将招募)
- 直接回车使用默认

#### 6️⃣ 地区国家选择
```
地区国家选择:
   常用选项:
   • china: 中国
   • united states: 美国
   • japan: 日本
   • korea: 韩国
   • singapore: 新加坡
   • australia: 澳大利亚
   • canada: 加拿大
   • united kingdom: 英国
   默认: china (中国)
请输入地区/国家 (英文名称，回车使用默认): 
```

**示例输入：**
- `china` (中国，默认)
- `united states` (美国)
- `japan` (日本)
- `korea` (韩国)
- `singapore` (新加坡)
- 直接回车使用默认中国

## 📊 搜索场景示例

### 场景1: 寻找最新的早期试验
```
搜索关键词: pancreatic cancer
首次发布日期: 2025-01-01
搜索天数: 30
试验阶段: 1,2
试验状态: RECRUITING
地区国家: china
```
**适用于：** 寻找最新发布的早期阶段试验

### 场景2: 查找美国的所有活跃试验
```
搜索关键词: pancreatic adenocarcinoma
首次发布日期: (回车跳过)
搜索天数: 60
试验阶段: (回车选择全部)
试验状态: RECRUITING NOT_YET_RECRUITING
地区国家: united states
```
**适用于：** 查找美国地区的活跃试验

### 场景3: 查找亚洲地区的免疫治疗试验
```
搜索关键词: pancreatic cancer immunotherapy
首次发布日期: 2024-06-01
搜索天数: 180
试验阶段: (回车选择全部)
试验状态: RECRUITING ACTIVE_NOT_RECRUITING
地区国家: japan
```
**适用于：** 查找日本地区的免疫治疗试验

### 场景4: 专注于后期大型试验
```
搜索关键词: PDAC
首次发布日期: 2024-01-01
搜索天数: 365
试验阶段: 3,4
试验状态: RECRUITING
地区国家: china
```
**适用于：** 寻找中国地区成熟的后期阶段试验

## 🔗 对应的ClinicalTrials.gov搜索链接

系统会根据您的输入参数自动构建对应的ClinicalTrials.gov搜索链接，例如：

```
https://clinicaltrials.gov/search?cond=Pancreatic%20Cancer&aggFilters=phase:1%202%203%204,status:rec&firstPost=2025-01-01_
```

**链接参数说明：**
- `cond`: 搜索条件（疾病名称）
- `aggFilters`: 聚合过滤器
  - `phase`: 试验阶段 (0,1,2,3,4)
  - `status`: 试验状态 (rec=招募中, not=尚未招募, act=活跃不招募)
- `firstPost`: 首次发布日期过滤

## 📄 输出报告

搜索完成后，系统会生成包含以下内容的Markdown报告：

- 📊 **搜索参数总结**
- 📈 **结果统计信息**
- 📋 **详细试验列表**
- 🌐 **双语显示** (如启用翻译功能)
- 🔗 **相关链接**

报告文件命名格式：`YYYY-MM-DD_胰腺癌临床试验报告.md`

## ⚙️ 高级功能

### 翻译功能
如果配置了翻译功能，报告将包含中英文双语内容：
- 试验标题翻译
- 试验描述翻译
- 关键信息本地化

### 缓存机制
系统具备智能缓存功能：
- 避免重复API调用
- 提高查询效率
- 减少网络延迟

## 🛠️ 故障排除

### 常见问题

1. **日期格式错误**
   - 确保使用 `YYYY-MM-DD` 格式
   - 例如：`2025-01-01`

2. **阶段输入无效**
   - 仅支持 0,1,2,3,4
   - 使用逗号分隔：`1,2,3`

3. **状态输入无效**
   - 支持的状态：`RECRUITING`, `NOT_YET_RECRUITING`, `ACTIVE_NOT_RECRUITING`
   - 大小写不敏感

4. **网络连接问题**
   - 检查网络连接
   - 确认ClinicalTrials.gov API可访问

### 日志信息
程序运行时会显示详细的日志信息，包括：
- 搜索参数确认
- API调用状态
- 数据处理进度
- 错误信息（如有）

## 📞 技术支持

如遇到问题，请检查：
1. Python环境是否正确安装
2. 必要的依赖包是否已安装
3. 网络连接是否正常
4. 配置文件是否正确设置

---

**更新日期：** 2025-01-07  
**版本：** v2.0 - 完整交互式功能版本